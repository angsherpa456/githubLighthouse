name: Scheduled workflow for lighthouse CI
'on':
  schedule:
    - cron: '*/3 * * * *'
jobs:
  singleJobName:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
        with:
          ref: '${{ env.DELAYED_JOB_CHECKOUT_REF }}'
      - name: Check the staging version in every 20 minutes
        run: >
          response=$(curl -X GET "https://lite-stage-de.flaconi.de/api/version"
          | jq -r '.version')

          echo stagingVersion="$response"

          echo stagingVersion is $stagingVersion
      - name: lighthouse CI
        id: actualWorkStep
        continue-on-error: true
        run: exit 1
      - name: Just testing step
        run: >-
          echo This is from delayed file after 3 minutes and the variable is ${{
          env.DELAYED_JOB_PAYLOAD }}
      - name: Remove scheduled job
        if: github.run_number > 3
        uses: cardinalby/unschedule-job-action@v1
        with:
          ghToken: '${{ secrets.PERSONAL_TOKEN }}'
    env:
      DELAYED_JOB_CHECKOUT_REF: 0023af094cefd32e4f17ee01297727876c0352d4
      DELAYED_JOB_CHECKOUT_REF_IS_TAG: 'false'
      DELAYED_JOB_WORKFLOW_FILE_PATH: .github/workflows/example-0023af094cefd32e4f17ee01297727876c0352d4.yml
      DELAYED_JOB_WORKFLOW_UNSCHEDULE_TARGET_BRANCH: master
      DELAYED_JOB_PAYLOAD: 2022.07.13.07.14
